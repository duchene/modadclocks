# This function computes the multinomial likelihood test statistic as proposed by Bollback (2002).

require(phangorn)

multlik <- function(al){

	if(class(al) != "DNAbin"){ al <- as.list(as.DNAbin(al)) } else { al <- as.list(al) }
	mat <- as.character(al[[1]])
	for(i in 2:length(al)){
	      mat <- rbind(mat, as.character(al[[i]]))
	}
	al <- mat
	nsites <- ncol(al)
	usites <- unique(al, MARGIN = 2)
	liks <- vector()
	for(i in 1:ncol(usites)){
	      insts <- ncol(al[, apply(al, 2, identical, usites[, i])])
	      liks[i] <- (insts / nsites)^insts
	}
	print(head(liks))
	mlik <- log(prod(liks))

	return(mlik)
}
